{
  "id": "note-1766242883657",
  "title": "Welcome",
  "updated": "21/12/2025, 14:12:40",
  "pinned": true,
  "content": "<div>/* =========================================================</div><div>&nbsp; &nbsp;CONFIG</div><div>========================================================= */</div><div>const BACKEND_URL = \"https://notepad-backend-n5nc.onrender.com\";</div><div><br></div><div>let notes = [];</div><div>let activeNoteId = null;</div><div>let autoSaveTimer = null;</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;CONNECTION INDICATOR</div><div>========================================================= */</div><div>const indicator = document.getElementById(\"conn-indicator\");</div><div><br></div><div>async function pingBackend() {</div><div>&nbsp; try {</div><div>&nbsp; &nbsp; indicator.className = \"conn-spinner\";</div><div>&nbsp; &nbsp; indicator.innerHTML = \"\";</div><div>&nbsp; &nbsp; await fetch(BACKEND_URL + \"/\", { cache: \"no-store\" });</div><div>&nbsp; &nbsp; indicator.className = \"conn-online\";</div><div>&nbsp; &nbsp; indicator.innerHTML = \"‚úì\";</div><div>&nbsp; } catch {</div><div>&nbsp; &nbsp; indicator.className = \"conn-spinner\";</div><div>&nbsp; &nbsp; indicator.innerHTML = \"\";</div><div>&nbsp; }</div><div>}</div><div>pingBackend();</div><div>setInterval(pingBackend, 25000);</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;SIDEBAR (MOBILE)</div><div>========================================================= */</div><div>function toggleSidebar() {</div><div>&nbsp; document.getElementById(\"sidebar\").classList.toggle(\"open\");</div><div>&nbsp; document.getElementById(\"mobileOverlay\").classList.toggle(\"active\");</div><div>}</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;LOAD NOTES</div><div>========================================================= */</div><div>async function loadNotes() {</div><div>&nbsp; try {</div><div>&nbsp; &nbsp; const r = await fetch(BACKEND_URL + \"/api/index\");</div><div>&nbsp; &nbsp; notes = await r.json();</div><div>&nbsp; &nbsp; renderNotesList();</div><div>&nbsp; } catch (e) {</div><div>&nbsp; &nbsp; console.error(\"Failed to load notes\", e);</div><div>&nbsp; }</div><div>}</div><div>loadNotes();</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;RENDER NOTES LIST (PINNED ON TOP)</div><div>========================================================= */</div><div>function renderNotesList() {</div><div>&nbsp; const list = document.getElementById(\"notesList\");</div><div>&nbsp; list.innerHTML = \"\";</div><div><br></div><div>&nbsp; const pinnedNotes = notes.filter(n =&gt; n.pinned === true);</div><div>&nbsp; const normalNotes = notes.filter(n =&gt; !n.pinned);</div><div>&nbsp; const orderedNotes = [...pinnedNotes, ...normalNotes];</div><div><br></div><div>&nbsp; orderedNotes.forEach(note =&gt; {</div><div>&nbsp; &nbsp; const div = document.createElement(\"div\");</div><div>&nbsp; &nbsp; div.className =</div><div>&nbsp; &nbsp; &nbsp; \"note-item\" + (note.id === activeNoteId ? \" active\" : \"\");</div><div><br></div><div>&nbsp; &nbsp; div.style.display = \"flex\";</div><div>&nbsp; &nbsp; div.style.justifyContent = \"space-between\";</div><div>&nbsp; &nbsp; div.style.alignItems = \"center\";</div><div><br></div><div>&nbsp; &nbsp; const info = document.createElement(\"div\");</div><div>&nbsp; &nbsp; info.style.flex = \"1\";</div><div>&nbsp; &nbsp; info.innerHTML = `</div><div>&nbsp; &nbsp; &nbsp; &lt;strong&gt;${note.title || \"Untitled\"}&lt;/strong&gt;&lt;br&gt;</div><div>&nbsp; &nbsp; &nbsp; &lt;small&gt;${note.updated || \"\"}&lt;/small&gt;</div><div>&nbsp; &nbsp; `;</div><div><br></div><div>&nbsp; &nbsp; /* üìå PIN ICON */</div><div>&nbsp; &nbsp; const pinBtn = document.createElement(\"span\");</div><div>&nbsp; &nbsp; pinBtn.innerHTML = note.pinned ? \"üìå\" : \"üìç\";</div><div>&nbsp; &nbsp; pinBtn.title = note.pinned ? \"Unpin note\" : \"Pin note\";</div><div>&nbsp; &nbsp; pinBtn.style.cursor = \"pointer\";</div><div>&nbsp; &nbsp; pinBtn.style.fontSize = \"22px\";</div><div>&nbsp; &nbsp; pinBtn.style.marginRight = \"10px\";</div><div>&nbsp; &nbsp; pinBtn.style.userSelect = \"none\";</div><div><br></div><div>&nbsp; &nbsp; pinBtn.onclick = (e) =&gt; {</div><div>&nbsp; &nbsp; &nbsp; e.stopPropagation();</div><div>&nbsp; &nbsp; &nbsp; togglePin(note.id);</div><div>&nbsp; &nbsp; };</div><div><br></div><div>&nbsp; &nbsp; /* üóëÔ∏è DELETE */</div><div>&nbsp; &nbsp; const del = document.createElement(\"span\");</div><div>&nbsp; &nbsp; del.innerHTML = \"üóëÔ∏è\";</div><div>&nbsp; &nbsp; del.style.cursor = \"pointer\";</div><div>&nbsp; &nbsp; del.title = \"Delete note\";</div><div>&nbsp; &nbsp; del.onclick = (e) =&gt; {</div><div>&nbsp; &nbsp; &nbsp; e.stopPropagation();</div><div>&nbsp; &nbsp; &nbsp; deleteNote(note.id);</div><div>&nbsp; &nbsp; };</div><div><br></div><div>&nbsp; &nbsp; div.onclick = () =&gt; openNote(note.id);</div><div><br></div><div>&nbsp; &nbsp; div.appendChild(info);</div><div>&nbsp; &nbsp; div.appendChild(pinBtn);</div><div>&nbsp; &nbsp; div.appendChild(del);</div><div>&nbsp; &nbsp; list.appendChild(div);</div><div>&nbsp; });</div><div>}</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;ADD NEW NOTE&nbsp; (TITLE BUG FIXED, NO DATA LOSS)</div><div>========================================================= */</div><div>function addNewNote() {</div><div>&nbsp; const title = prompt(\"Enter note title\");</div><div>&nbsp; if (!title || !title.trim()) return;</div><div><br></div><div>&nbsp; const id = \"note-\" + Date.now();</div><div>&nbsp; const now = new Date().toLocaleString();</div><div><br></div><div>&nbsp; const newNote = {</div><div>&nbsp; &nbsp; id,</div><div>&nbsp; &nbsp; title: title.trim(),</div><div>&nbsp; &nbsp; content: \"\",&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // üîë important</div><div>&nbsp; &nbsp; updated: now,</div><div>&nbsp; &nbsp; pinned: false</div><div>&nbsp; };</div><div><br></div><div>&nbsp; notes.unshift(newNote);</div><div>&nbsp; activeNoteId = id;</div><div><br></div><div>&nbsp; document.getElementById(\"note-title\").value = newNote.title;</div><div>&nbsp; document.getElementById(\"rich-editor\").innerHTML = \"\";</div><div><br></div><div>&nbsp; renderNotesList();</div><div>}</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;OPEN NOTE</div><div>========================================================= */</div><div>async function openNote(id) {</div><div>&nbsp; try {</div><div>&nbsp; &nbsp; activeNoteId = id;</div><div><br></div><div>&nbsp; &nbsp; const r = await fetch(`${BACKEND_URL}/api/note/${id}`);</div><div>&nbsp; &nbsp; const note = await r.json();</div><div><br></div><div>&nbsp; &nbsp; document.getElementById(\"note-title\").value = note.title || \"\";</div><div>&nbsp; &nbsp; document.getElementById(\"rich-editor\").innerHTML = note.content || \"\";</div><div><br></div><div>&nbsp; &nbsp; const local = notes.find(n =&gt; n.id === id);</div><div>&nbsp; &nbsp; if (local) {</div><div>&nbsp; &nbsp; &nbsp; local.title = note.title;</div><div>&nbsp; &nbsp; &nbsp; local.content = note.content;</div><div>&nbsp; &nbsp; &nbsp; local.pinned = note.pinned;</div><div>&nbsp; &nbsp; &nbsp; local.updated = note.updated;</div><div>&nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; renderNotesList();</div><div>&nbsp; &nbsp; document.getElementById(\"rich-editor\").focus();</div><div><br></div><div>&nbsp; &nbsp; if (window.innerWidth &lt;= 768) {</div><div>&nbsp; &nbsp; &nbsp; document.getElementById(\"sidebar\").classList.remove(\"open\");</div><div>&nbsp; &nbsp; &nbsp; document.getElementById(\"mobileOverlay\").classList.remove(\"active\");</div><div>&nbsp; &nbsp; }</div><div>&nbsp; } catch {</div><div>&nbsp; &nbsp; alert(\"Failed to load note\");</div><div>&nbsp; }</div><div>}</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;SAVE NOTE (MANUAL + AUTOSAVE SAFE)</div><div>========================================================= */</div><div>function saveNote(showAlert = true) {</div><div>&nbsp; if (!activeNoteId) return;</div><div><br></div><div>&nbsp; const note = notes.find(n =&gt; n.id === activeNoteId);</div><div>&nbsp; if (!note) return;</div><div><br></div><div>&nbsp; note.title = document.getElementById(\"note-title\").value;</div><div>&nbsp; note.content = document.getElementById(\"rich-editor\").innerHTML;</div><div>&nbsp; note.updated = new Date().toLocaleString();</div><div><br></div><div>&nbsp; fetch(BACKEND_URL + \"/api/save\", {</div><div>&nbsp; &nbsp; method: \"POST\",</div><div>&nbsp; &nbsp; headers: { \"Content-Type\": \"application/json\" },</div><div>&nbsp; &nbsp; body: JSON.stringify(note)</div><div>&nbsp; });</div><div><br></div><div>&nbsp; renderNotesList();</div><div>&nbsp; if (showAlert) alert(\"Note saved successfully\");</div><div>}</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;AUTO SAVE</div><div>========================================================= */</div><div>function autoSave() {</div><div>&nbsp; clearTimeout(autoSaveTimer);</div><div>&nbsp; autoSaveTimer = setTimeout(() =&gt; saveNote(false), 1200);</div><div>}</div><div>document.getElementById(\"note-title\").addEventListener(\"input\", autoSave);</div><div>document.getElementById(\"rich-editor\").addEventListener(\"input\", autoSave);</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;DELETE NOTE</div><div>========================================================= */</div><div>async function deleteNote(id) {</div><div>&nbsp; const yes = confirm(\"Are you sure you want to delete this note?\");</div><div>&nbsp; if (!yes) return;</div><div><br></div><div>&nbsp; try {</div><div>&nbsp; &nbsp; await fetch(`${BACKEND_URL}/api/delete/${id}`, { method: \"DELETE\" });</div><div>&nbsp; &nbsp; notes = notes.filter(n =&gt; n.id !== id);</div><div><br></div><div>&nbsp; &nbsp; if (activeNoteId === id) {</div><div>&nbsp; &nbsp; &nbsp; activeNoteId = null;</div><div>&nbsp; &nbsp; &nbsp; document.getElementById(\"note-title\").value = \"\";</div><div>&nbsp; &nbsp; &nbsp; document.getElementById(\"rich-editor\").innerHTML = \"\";</div><div>&nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; renderNotesList();</div><div>&nbsp; &nbsp; alert(\"Note deleted successfully\");</div><div>&nbsp; } catch {</div><div>&nbsp; &nbsp; alert(\"Failed to delete note\");</div><div>&nbsp; }</div><div>}</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;PIN / UNPIN (PERMANENT)</div><div>========================================================= */</div><div>function togglePin(id) {</div><div>&nbsp; const note = notes.find(n =&gt; n.id === id);</div><div>&nbsp; if (!note) return;</div><div><br></div><div>&nbsp; note.pinned = !note.pinned;</div><div>&nbsp; note.updated = new Date().toLocaleString();</div><div><br></div><div>&nbsp; fetch(BACKEND_URL + \"/api/save\", {</div><div>&nbsp; &nbsp; method: \"POST\",</div><div>&nbsp; &nbsp; headers: { \"Content-Type\": \"application/json\" },</div><div>&nbsp; &nbsp; body: JSON.stringify(note)</div><div>&nbsp; });</div><div><br></div><div>&nbsp; renderNotesList();</div><div>}</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;TEXT FORMATTING</div><div>========================================================= */</div><div>function applyFormat(cmd) {</div><div>&nbsp; const editor = document.getElementById(\"rich-editor\");</div><div>&nbsp; editor.focus();</div><div>&nbsp; document.execCommand(cmd, false, null);</div><div>}</div><div><br></div><div>/* =========================================================</div><div>&nbsp; &nbsp;FIND TEXT</div><div>========================================================= */</div><div>function toggleFind() {</div><div>&nbsp; const box = document.getElementById(\"findBox\");</div><div>&nbsp; box.style.display = box.style.display === \"block\" ? \"none\" : \"block\";</div><div>}</div><div><br></div><div>function findText() {</div><div>&nbsp; const input = document.getElementById(\"findInput\").value.toLowerCase();</div><div>&nbsp; const editor = document.getElementById(\"rich-editor\");</div><div><br></div><div>&nbsp; removeHighlights();</div><div>&nbsp; if (!input) return;</div><div><br></div><div>&nbsp; const regex = new RegExp(`(${input})`, \"gi\");</div><div>&nbsp; editor.innerHTML = editor.innerHTML.replace(</div><div>&nbsp; &nbsp; regex,</div><div>&nbsp; &nbsp; `&lt;span class=\"find-highlight\"&gt;$1&lt;/span&gt;`</div><div>&nbsp; );</div><div>}</div><div><br></div><div>function removeHighlights() {</div><div>&nbsp; const editor = document.getElementById(\"rich-editor\");</div><div>&nbsp; editor.querySelectorAll(\".find-highlight\").forEach(span =&gt; {</div><div>&nbsp; &nbsp; span.replaceWith(span.textContent);</div><div>&nbsp; });</div><div>}</div>"
}